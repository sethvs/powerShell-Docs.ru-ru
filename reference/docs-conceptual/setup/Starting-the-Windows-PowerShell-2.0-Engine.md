---
ms.date: 2017-06-05
keywords: "powershell,командлет"
title: "Запуск подсистемы Windows PowerShell 2.0"
ms.assetid: edafc2fa-7576-49c2-bbba-9336f4bcfc28
ms.openlocfilehash: 2e5c13cafdfd9fbe479fcad8ac81725cbd7ac3d9
ms.sourcegitcommit: d6ab9ab5909ed59cce4ce30e29457e0e75c7ac12
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/08/2017
---
# <a name="starting-the-windows-powershell-20-engine"></a><span data-ttu-id="c40e6-103">Запуск подсистемы Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c40e6-103">Starting the Windows PowerShell 2.0 Engine</span></span>
<span data-ttu-id="c40e6-104">В этой статье объясняется, как запустить модуль Windows PowerShell 2.0 в Windows 8.1, Windows Server 2012 R2, Windows 8 и Windows Server 2012 с установленной подсистемой Windows PowerShell 2.0 и в других системах, в которых установлены Windows PowerShell 2.0, Windows PowerShell 3.0 и Windows PowerShell 4.0.</span><span class="sxs-lookup"><span data-stu-id="c40e6-104">This section explains how to start the Windows PowerShell 2.0 Engine on Windows 8.1, Windows Server 2012 R2, Windows 8, and Windows Server 2012, which include the Windows PowerShell 2.0 Engine, and on other systems on which Windows PowerShell 2.0, Windows PowerShell 3.0, and Windows PowerShell 4.0 are installed.</span></span>

<span data-ttu-id="c40e6-105">Windows PowerShell 4.0 и Windows PowerShell 3.0 предназначены для обратной совместимости с Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="c40e6-105">Windows PowerShell 4.0 and Windows PowerShell 3.0 are designed to be backwards compatible with Windows PowerShell 2.0.</span></span> <span data-ttu-id="c40e6-106">Командлеты, поставщики, оснастки, модули и сценарии, написанные для Windows PowerShell 2.0, выполняются и в Windows PowerShell 4.0, и в Windows PowerShell 3.0 без изменений.</span><span class="sxs-lookup"><span data-stu-id="c40e6-106">Cmdlets, providers, snap-ins, modules, and scripts written for Windows PowerShell 2.0 run unchanged in Windows PowerShell 4.0 and Windows PowerShell 3.0.</span></span> <span data-ttu-id="c40e6-107">Однако из-за изменений в политике активации среды выполнения в Microsoft .NET Framework 4 основные программы Windows PowerShell, написанные для Windows PowerShell 2.0 и скомпилированные с помощью среды CLR 2.0, не могут выполняться без изменения в Windows PowerShell 3.0 или Windows PowerShell 4.0, которые компилируются в среде CLR 4.0.</span><span class="sxs-lookup"><span data-stu-id="c40e6-107">However, due to a change in the runtime activation policy in Microsoft .NET Framework 4, Windows PowerShell host programs that were written for Windows PowerShell 2.0 and compiled with Common Language Runtime (CLR) 2.0 cannot run without modification in Windows PowerShell 3.0 or Windows PowerShell 4.0, which are compiled with CLR 4.0.</span></span> <span data-ttu-id="c40e6-108">Подсистема Windows PowerShell 2.0 предназначена для использования только в том случае, если выполнение существующего сценария или существующей основной программы невозможно из-за несовместимости с Windows PowerShell 4.0, Windows PowerShell 3.0 или Microsoft .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="c40e6-108">The Windows PowerShell 2.0 Engine is intended to be used only when an existing script or host program cannot run because it is incompatible with Windows PowerShell 4.0, Windows PowerShell 3.0, or Microsoft .NET Framework 4.</span></span> <span data-ttu-id="c40e6-109">Такие ситуации довольно редки.</span><span class="sxs-lookup"><span data-stu-id="c40e6-109">Such cases are expected to be rare.</span></span>

<span data-ttu-id="c40e6-110">Многие программы, требующие использования подсистемы Windows PowerShell 2.0, запускают ее автоматически.</span><span class="sxs-lookup"><span data-stu-id="c40e6-110">Many programs that require the Windows PowerShell 2.0 Engine start it automatically.</span></span> <span data-ttu-id="c40e6-111">Эти инструкции предназначены для редких случаев, когда подсистему необходимо запустить вручную.</span><span class="sxs-lookup"><span data-stu-id="c40e6-111">These instructions are included for the rare situations in which you need to start the engine manually.</span></span>

## <a name="installing-and-enabling-required-programs"></a><span data-ttu-id="c40e6-112">Установка и включение требуемых программ</span><span class="sxs-lookup"><span data-stu-id="c40e6-112">Installing and Enabling Required Programs</span></span>
<span data-ttu-id="c40e6-113">Перед запуском подсистемы Windows PowerShell 2.0 включите подсистему Windows PowerShell 2.0 и Microsoft .NET Framework 3.5 с пакетом обновления 1.</span><span class="sxs-lookup"><span data-stu-id="c40e6-113">Before starting the Windows PowerShell 2.0 Engine, enable the Windows PowerShell 2.0 Engine and Microsoft .NET Framework 3.5 with Service Pack 1.</span></span> <span data-ttu-id="c40e6-114">Инструкции см. в статье [Установка Windows PowerShell](Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="c40e6-114">For instructions, see [Installing Windows PowerShell](Installing-Windows-PowerShell.md).</span></span>

<span data-ttu-id="c40e6-115">Системы, где установлена [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) или Windows PowerShell 3.0, имеют все необходимые компоненты.</span><span class="sxs-lookup"><span data-stu-id="c40e6-115">Systems on which [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) or Windows Management Framework 3.0 are installed have all of the required components.</span></span> <span data-ttu-id="c40e6-116">Никакая дополнительная настройка не требуется.</span><span class="sxs-lookup"><span data-stu-id="c40e6-116">No further configuration is necessary.</span></span> <span data-ttu-id="c40e6-117">Дополнительные сведения об установке [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) или Windows PowerShell 3.0 см. в статье [Установка Windows PowerShell](Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="c40e6-117">For information about installing [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) or Windows Management Framework 3.0, see [Installing Windows PowerShell](Installing-Windows-PowerShell.md).</span></span>

## <a name="how-to-start-the-windows-powershell-20-engine"></a><span data-ttu-id="c40e6-118">Запуск подсистемы Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c40e6-118">How to start the Windows PowerShell 2.0 Engine</span></span>
<span data-ttu-id="c40e6-119">При запуске Windows PowerShell по умолчанию открывается самая новая версия.</span><span class="sxs-lookup"><span data-stu-id="c40e6-119">When you start Windows PowerShell the newest version starts by default.</span></span> <span data-ttu-id="c40e6-120">Для запуска Windows PowerShell с подсистемой Windows PowerShell 2.0 используйте параметр Version в PowerShell.exe.</span><span class="sxs-lookup"><span data-stu-id="c40e6-120">To start Windows PowerShell with the Windows PowerShell 2.0 Engine, use the Version parameter of PowerShell.exe.</span></span> <span data-ttu-id="c40e6-121">Команду можно выполнить в любой командной строке, включая Windows PowerShell и Cmd.exe.</span><span class="sxs-lookup"><span data-stu-id="c40e6-121">You can run the command at any command prompt, including Windows PowerShell and Cmd.exe.</span></span>

```
PowerShell.exe -Version 2
```

## <a name="how-to-start-a-remote-session-with-the-windows-powershell-20-engine"></a><span data-ttu-id="c40e6-122">Запуск удаленного сеанса с помощью подсистемы Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c40e6-122">How to start a remote session with the Windows PowerShell 2.0 Engine</span></span>
<span data-ttu-id="c40e6-123">Чтобы запустить подсистему Windows PowerShell 2.0 в удаленном сеансе, создайте его конфигурацию (которая также называется "конечной точкой") на удаленном компьютере, которая загружает подсистему Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="c40e6-123">To run the Windows PowerShell 2.0 Engine in a remote session, create a session configuration (also known as an "endpoint") on the remote computer that loads the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="c40e6-124">Конфигурация сеанса сохраняется на удаленном компьютере и может использоваться любым авторизованным пользователем для создания сеансов с подсистемой Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="c40e6-124">The session configuration is saved on the remote computer and can be used by any authorized user to create  sessions that use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="c40e6-125">Это сложная задача, которая обычно выполняется системным администратором.</span><span class="sxs-lookup"><span data-stu-id="c40e6-125">This is an advanced task that is typically performed by a system administrator.</span></span>

<span data-ttu-id="c40e6-126">Следующая процедура использует параметр **PSVersion** командлета [Register-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) для создания конфигурации сеанса с подсистемой Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="c40e6-126">The following procedure uses the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet to create a session configuration that uses the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="c40e6-127">Можно также использовать параметр **PowerShellVersion** командлета [New-PSSessionConfigurationFile](https://technet.microsoft.com/en-us/library/5f3e3633-6e90-479c-aea9-ba45a1954866), чтобы создать файл конфигурации для сеанса, который загружает подсистему Windows PowerShell 2.0, и параметр **PSVersion** командлета [Set-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/b21fbad3-1759-4260-b206-dcb8431cd6ea), чтобы изменить конфигурацию сеанса для использования подсистемы Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="c40e6-127">You can also use the **PowerShellVersion** parameter of the [New-PSSessionConfigurationFile](https://technet.microsoft.com/en-us/library/5f3e3633-6e90-479c-aea9-ba45a1954866) cmdlet to create a session configuration file for a session that loads the Windows PowerShell 2.0 Engine and you can use the **PSVersion** parameter of the [Set-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) parameter to change a session configuration to use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="c40e6-128">Дополнительные сведения о файлах конфигурации сеанса см. в статье [about_Session_Configuration_Files](https://technet.microsoft.com/en-us/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8). Сведения о конфигурациях сеанса, включая настройку и обеспечение безопасности, см. в статье [about_Session_Configurations [v4]](https://technet.microsoft.com/en-us/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span><span class="sxs-lookup"><span data-stu-id="c40e6-128">For more information about session configuration files, see [about_Session_Configuration_Files](https://technet.microsoft.com/en-us/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8).For information about session configurations, including setup and security, see [about_Session_Configurations [v4]](https://technet.microsoft.com/en-us/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span></span>

#### <a name="to-start-a-remote-windows-powershell-20-session"></a><span data-ttu-id="c40e6-129">Запуск удаленного сеанса Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c40e6-129">To start a remote Windows PowerShell 2.0 session</span></span>

1. <span data-ttu-id="c40e6-130">Для создания конфигурации сеанса, требующей подсистемы Windows PowerShell 2.0 , используйте параметр **PSVersion** командлета [Register-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) со значением "2.0".</span><span class="sxs-lookup"><span data-stu-id="c40e6-130">To create a session configuration that requires the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet with a value of "2.0".</span></span> <span data-ttu-id="c40e6-131">Выполните команду на компьютере на "стороне сервера" или на принимающей стороне подключения.</span><span class="sxs-lookup"><span data-stu-id="c40e6-131">Run this command on the computer at the "server side" or receiving end of the connection.</span></span>

    <span data-ttu-id="c40e6-132">Следующий пример команды создает конфигурацию сеанса PS2 на компьютере Server01.</span><span class="sxs-lookup"><span data-stu-id="c40e6-132">The following sample command creates the PS2 session configuration on the Server01 computer.</span></span> <span data-ttu-id="c40e6-133">Чтобы выполнить эту команду, запустите Windows PowerShell 4.0 или Windows PowerShell 3.0 с параметром **Запуск от имени администратора**.</span><span class="sxs-lookup"><span data-stu-id="c40e6-133">To run this command, start Windows PowerShell 4.0 or Windows PowerShell 3.0 with the **Run as administrator** option.</span></span>

    ```
    Register-PSSessionConfiguration -Name PS2 -PSVersion 2.0
    ```

2. <span data-ttu-id="c40e6-134">Чтобы создать на компьютере Server01 сеанс, использующий конфигурацию сеанса PS2, примените параметр **ConfigurationName** для командлетов, создающих удаленный сеанс, таких как [New-PSSession](https://technet.microsoft.com/en-us/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f).</span><span class="sxs-lookup"><span data-stu-id="c40e6-134">To create a session on the Server01 computer that uses the PS2 session configuration, use the **ConfigurationName** parameter of cmdlets that create a remote session, such as the [New-PSSession](https://technet.microsoft.com/en-us/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f) cmdlet.</span></span>

    <span data-ttu-id="c40e6-135">При запуске сеанса, использующего конфигурацию, подсистема Windows PowerShell 2.0 автоматически загружается в него.</span><span class="sxs-lookup"><span data-stu-id="c40e6-135">When a session that uses the session configuration starts, the Windows PowerShell 2.0 Engine is automatically loaded into the session.</span></span>

    <span data-ttu-id="c40e6-136">Следующая команда запускает сеанс на компьютере Server01, который использует конфигурацию PS2.</span><span class="sxs-lookup"><span data-stu-id="c40e6-136">The following command starts a session on the Server01 computer that uses the PS2 session configuration.</span></span> <span data-ttu-id="c40e6-137">Сеанс сохраняется в переменную $s.</span><span class="sxs-lookup"><span data-stu-id="c40e6-137">The command saves the session in the $s variable.</span></span>

    ```
    $s = New-PSSession -ComputerName Server01 -ConfigurationName PS2
    ```

## <a name="how-to-start-a-background-job-with-the-windows-powershell-20-engine"></a><span data-ttu-id="c40e6-138">Запуск фонового задания с помощью подсистемы Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c40e6-138">How to start a background job with the Windows PowerShell 2.0 Engine</span></span>
<span data-ttu-id="c40e6-139">Чтобы запустить фоновое задание с помощью подсистемы Windows PowerShell 2.0, используйте параметр **PSVersion** командлета [Start-Job](https://technet.microsoft.com/en-us/library/2bc04935-0deb-4ec0-b856-d7290cca6442).</span><span class="sxs-lookup"><span data-stu-id="c40e6-139">To start a background job with the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Start-Job](https://technet.microsoft.com/en-us/library/2bc04935-0deb-4ec0-b856-d7290cca6442) cmdlet.</span></span>

<span data-ttu-id="c40e6-140">Следующая команда запускает фоновое задание с помощью подсистемы Windows PowerShell 2.0:</span><span class="sxs-lookup"><span data-stu-id="c40e6-140">The following command starts a background job with the Windows PowerShell 2.0 Engine</span></span>

```
Start-Job {Get-Process} -PSVersion 2.0
```

<span data-ttu-id="c40e6-141">Подробнее о фоновых заданиях см. в статье [about_Jobs [v4]](https://technet.microsoft.com/en-us/library/7362512a-8a4e-4575-b2ea-a740e5c4f002).</span><span class="sxs-lookup"><span data-stu-id="c40e6-141">For more information about background jobs, see [about_Jobs [v4]](https://technet.microsoft.com/en-us/library/7362512a-8a4e-4575-b2ea-a740e5c4f002).</span></span>

