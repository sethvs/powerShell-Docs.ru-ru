---
title: Написание и выполнение сценариев в интегрированной среде сценариев Windows PowerShell
ms.custom: na
ms.reviewer: na
ms.suite: na
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 62f916d9-b3a1-484a-bdfb-41f57112c22b
---
# Написание и выполнение сценариев в интегрированной среде сценариев Windows PowerShell
Эта статья содержит инструкции по созданию, редактированию, выполнению и сохранению сценариев в области сценариев.

-   [Создание и выполнение сценариев](#bkmk_1)

-   [Написание и редактирование текста в области сценариев](#bkmk_2)

-   [Сохранение сценария](#bkmk_3)

## <a name="bkmk_1"></a> Создание и выполнение сценариев
В области сценариев можно открывать и редактировать файлы [!INCLUDE[wps_1](../Token/wps_1_md.md)]. Сейчас нас интересуют следующие типы файлов [!INCLUDE[wps_1](../Token/wps_1_md.md)]: файлы сценариев (PS1), файлы данных сценариев (PSD1) и файлы модулей сценариев (PSM1). Эти типы файлов имеют цветовую подсветку синтаксиса в редакторе области сценариев. Другие стандартные файлы, которые можно открыть в области сценариев, — это файлы конфигурации (PS1XML), файлы XML и текстовые файлы.

> [!NOTE]
> Политика выполнения [!INCLUDE[wps_2](../Token/wps_2_md.md)] определяет, можно ли выполнять сценарии, загружать профили Windows PowerShell и файлы конфигурации. Политика выполнения по умолчанию, "Restricted", запрещает выполнение сценариев и предотвращает загрузку профилей. Чтобы изменить эту политику выполнения и разрешить загрузку и использование профилей, изучите статьи [Set-ExecutionPolicy[PSITPro5_Security]](assetId:///5690a0e1-495b-4e63-8280-65ead7bf01ab) и [about_Signing [v4]](assetId:///fcbdd3b9-0b9f-4734-b5c7-e0dcc304fa1d).

### Создание файла сценария
Нажмите кнопку **Создать** на панели инструментов или откройте меню **Файл** и выберите пункт **Создать**. Созданный файл появится в новой вкладке, расположенной под текущей вкладкой PowerShell. Помните, что вкладки PowerShell отображаются, только если их несколько. По умолчанию создается файл типа сценарий (PS1), но его можно сохранить с новым именем и расширением. На одной вкладке PowerShell может быть создано несколько файлов-сценариев.

### Открытие существующего сценария
Нажмите кнопку **Открыть...** на панели инструментов или откройте меню **Файл** и выберите пункт **Открыть**. В диалоговом окне **Открыть** выберите файл, который требуется открыть. Открытый файл появится в новой вкладке.

### Закрытие вкладки сценарий
Щелкните вкладку того сценария, который нужно закрыть, а затем выполните одно из следующих действий:

1.  Щелкните значок **Закрыть** (X) на вкладке сценария.

2.  Выберите пункт **Закрыть** в меню **Файл**.

Если файл был изменен с момента последнего сохранения, будет предложено сохранить или отменить изменения.

### Отображение пути к файлу
На вкладке файла наведите курсор на его имя. Появится подсказка с полным путем к файлу сценария.

### Запуск сценария
Нажмите кнопку **Выполнить сценарий** на панели инструментов или откройте меню **Файл** и выберите пункт **Выполнить**.

### Выполнение части сценария

1.  Выберите часть сценария в области сценариев.

2.  Нажмите кнопку **Выполнить выделенный фрагмент** на панели инструментов или откройте меню **Файл** и выберите пункт **Выполнить выделенный фрагмент**.

### Остановка выполняемого сценария
Нажмите кнопку **Остановить операцию** на панели инструментов, нажмите клавиши CTRL+BREAK или выберите пункт **Остановить операцию** в меню **Файл**. Нажатие клавиш **CTRL+C** также сработает, если нет выделенного текста, в противном случае сочетание клавиш **CTRL+C** назначено функции копирования для выделенного текста.

## <a name="bkmk_2"></a> Написание и редактирование текста в области сценариев
Для редактирования текста в области сценариев выполните описанные ниже действия. Текст можно копировать, вырезать, вставлять, искать и заменять. Также можно отменить и повторить последнее выполненное действие. Для этого используются такие же сочетания клавиш, как и во всех других приложениях Windows.

### Ввод текста в области сценариев

1.  Установите курсор в область сценариев, щелкнув кнопкой мыши любую ее часть или выбрав пункт **Перейти в область сценариев** в меню **Вид**.

2.  Создайте сценарий. Цветовая подсветка синтаксиса и заполнение нажатием клавиши TAB делают эту задачу гораздо проще в [!INCLUDE[ise_2](../Token/ise_2_md.md)].

3.  Подробную информацию о заполнении нажатием клавиши TAB, помогающем при вводе кода, см. в статье [How to Use Tab Completion in the Script Pane and Console Pane](../Topic/How-to-Use-Tab-Completion-in-the-Script-Pane-and-Console-Pane.md) (Использование заполнения нажатием клавиши TAB в областях сценариев и консоли).

### Поиск текста в области сценариев

1.  Чтобы найти где-либо текст, нажмите клавиши **CTRL+F** или выберите **Найти в сценарии** в меню **Правка**.

2.  Чтобы найти текст после курсора, нажмите клавишу **F3** или выберите **Найти следующее в сценарии** в меню **Правка**.

3.  Чтобы найти текст до курсора, нажмите клавиши **SHIFT+F3** или выберите **Найти предыдущее в сценарии** в меню **Правка**.

### Поиск и замена текста в области сценариев
Нажмите клавиши **CRTL+H** или выберите **Заменить в сценарии** в меню **Правка**. Введите искомый текст и текст, которым его нужно заменить, а затем нажмите клавишу **ВВОД**.

### Переход к определенной строке текста в области сценариев

1.  В области сценариев нажмите клавиши **CTRL+G** или выберите **Перейти к строке** в меню **Правка**.

2.  Введите номер строки.

### Копирование текста в области сценариев

1.  В области сценариев выделите текст, который требуется скопировать.

2.  Нажмите клавиши **CTRL+C**, щелкните значок **Копировать** на панели инструментов или выберите **Копировать** в меню **Правка**.

### Вырезание текста в области сценариев

1.  В области сценариев выделите текст, который требуется вырезать.

2.  Нажмите клавиши **CTRL+X**, щелкните значок **Вырезать** на панели инструментов или выберите **Вырезать** в меню **Правка**.

### Вставка текста в области сценариев
Нажмите клавиши **CTRL+V**, щелкните значок **Вставить** на панели инструментов или выберите **Вставить** в меню **Правка**.

### Отмена действия в области сценариев
Нажмите клавиши **CTRL+Z**, щелкните значок **Отменить** на панели инструментов или выберите **Отменить** в меню **Правка**.

### Повторное выполнение действия в области сценариев
Нажмите клавиши **CTRL+Y**, щелкните значок **Повторить** на панели инструментов или выберите **Повторить** в меню **Правка**.

## <a name="bkmk_3"></a> Сохранение сценария
Используйте следующие шаги, чтобы сохранить и назвать сценарий. Звездочка рядом с именем сценария обозначает, что файл не был сохранен после изменения. После сохранения звездочка исчезает.

### Сохранение сценария
Нажмите клавиши **CTRL+S**, щелкните значок **Сохранить** на панели инструментов или выберите **Сохранить** в меню **Файл**.

### Сохранение сценария с определенным именем

1.  В меню **Файл** выберите команду **Сохранить как**. Отображается диалоговое окно **Сохранить как**.

2.  В поле **Имя файла** введите имя файла.

3.  В поле **Тип файла** выберите тип файла. Например, в поле **Тип файла** выберите "Сценарии PowerShell (*.ps1)".

4.  Нажмите кнопку **Сохранить**.

### Сохранение сценария в кодировке ASCII
По умолчанию [!INCLUDE[ise_2](../Token/ise_2_md.md)] сохраняет новые файлы сценариев (PS1), файлы данных сценариев (PSD1) и файлы модулей сценариев (PSM1) в кодировке Юникод (BigEndianUnicode). Чтобы сохранить сценарий в другой кодировке, например ASCII (ANSI), используйте методы **Save** или **SaveAs** объекта [$psISE.CurrentFile](assetId:///bc3300e4-9c17-4f00-a621-c8867126e3b3#CurrentFile).

Следующая команда сохраняет новый сценарий в кодировке ASCII и с именем MyScript.ps1:

```
$psise.CurrentFile.SaveAs("MyScript.ps1", [System.Text.Encoding]::ASCII)
```

Следующая команда заменяет текущий файл сценария на файл с таким же именем, но в кодировке ASCII:

```
$psise.CurrentFile.Save([System.Text.Encoding]::ASCII)
```

Следующая команда возвращает кодировку текущего файла:

```
$psise.CurrentFile.encoding
```

[!INCLUDE[ise_2](../Token/ise_2_md.md)] поддерживает следующие параметры кодировки: ASCII, BigEndianUnicode, Unicode, UTF32, UTF7, UTF8 и Default. Значение параметра Default зависит от системы.

[!INCLUDE[ise_2](../Token/ise_2_md.md)] не изменяет кодировку сценариев, созданных в других редакторах, даже при использовании команд "Сохранить" или "Сохранить как" в [!INCLUDE[ise_2](../Token/ise_2_md.md)].

## См. также
[Использование интегрированной среды сценариев Windows PowerShell](../Topic/Using-the-Windows-PowerShell-ISE.md)



<!--HONumber=Apr16_HO1-->


